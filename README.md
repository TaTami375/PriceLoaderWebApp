# PriceLoaderWebApp

> –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–æ–≤ –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ —á–µ—Ä–µ–∑ IMAP, –ø–∞—Ä—Å–∏–Ω–≥–∞ CSV –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ PostgreSQL

## –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ ASP.NET Core Web API –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —Ä–µ–∞–ª–∏–∑—É—é—â–µ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∑–∞–≥—Ä—É–∑–∫—É –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–æ–≤ –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ "–û–û–û –î–æ—Å—Ç–∞–≤–∏–º –≤ —Å—Ä–æ–∫":
- –ü–æ–ª—É—á–∞–µ—Ç –ø–∏—Å—å–º–∞ —Å –≤–ª–æ–∂–µ–Ω–∏—è–º–∏ `.csv` —á–µ—Ä–µ–∑ IMAP
- –ü–∞—Ä—Å–∏—Ç —Ñ–∞–π–ª—ã —Å —É—á—ë—Ç–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –∫–æ–ª–æ–Ω–æ–∫
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ PostgreSQL

–ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∞—Å–∞–º–∏, ERP –∏–ª–∏ ETL –ø—Ä–æ—Ü–µ—Å—Å.

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|------------|---------------|
| C# / .NET 8 | Backend |
| ASP.NET Core | Web API |
| MailKit | –†–∞–±–æ—Ç–∞ —Å IMAP |
| CsvHelper | –ü–∞—Ä—Å–∏–Ω–≥ CSV |
| Entity Framework Core | ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î |
| PostgreSQL | –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |
| AutoMapper | –ú–∞–ø–ø–∏–Ω–≥ DTO ‚Üî Entities |
| Serilog (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | –õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ |

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/PriceLoaderWebApp
‚îú‚îÄ‚îÄ API/                   # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/
‚îú‚îÄ‚îÄ Application/            # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ Services/
‚îÇ   ‚îî‚îÄ‚îÄ DTOs/
‚îú‚îÄ‚îÄ Domain/                 # –°—É—â–Ω–æ—Å—Ç–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ Entities/
‚îÇ   ‚îî‚îÄ‚îÄ Exceptions/
‚îú‚îÄ‚îÄ Infrastructure/         # IMAP, –ë–î, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ Mail/
‚îÇ   ‚îú‚îÄ‚îÄ Persistence/
‚îÇ   ‚îî‚îÄ‚îÄ Configuration/
‚îú‚îÄ‚îÄ Mappings/               # AutoMapper –ø—Ä–æ—Ñ–∏–ª–∏
‚îú‚îÄ‚îÄ appsettings.json
‚îî‚îÄ‚îÄ PriceLoaderWebApp.csproj
```

---

## üì• –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/yourname/PriceLoaderWebApp.git
cd PriceLoaderWebApp
```

### 2. –ù–∞—Å—Ç—Ä–æ–π `appsettings.json`

–°–æ–∑–¥–∞–π –∏–ª–∏ –æ–±–Ω–æ–≤–∏ —Ñ–∞–π–ª `appsettings.json`:

```json
{
  "ImapSettings": {
    "Host": "imap.yandex.ru",
    "Port": 993,
    "Username": "TaTami375@yandex.ru",
    "Password": "–≤–∞—à_–ø–∞—Ä–æ–ª—å_–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"
  },
  "Supplier": {
    "Name": "–û–û–û –î–æ—Å—Ç–∞–≤–∏–º –≤ —Å—Ä–æ–∫",
    "ColumnMapping": {
      "Vendor": "–ë—Ä–µ–Ω–¥",
      "Number": "–ê—Ä—Ç–∏–∫—É–ª",
      "Description": "–û–ø–∏—Å–∞–Ω–∏–µ",
      "Price": "–¶–µ–Ω–∞, —Ä—É–±.",
      "Count": "–ù–∞–ª–∏—á–∏–µ"
    }
  },
  "ConnectionStrings": {
    "DefaultConnection": "Host=localhost;Port=5432;Database=priceloaderdb;Username=postgres;Password=yourpassword"
  }
}
```

### 3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
dotnet restore
```

### 4. –°–æ–±–µ—Ä–∏ –∏ –∑–∞–ø—É—Å—Ç–∏:

```bash
dotnet build
dotnet run
```

---

## –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã API

### –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–∞–π—Å-–ª–∏—Å—Ç

**POST** `/api/Price/load`  
–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞: `"–û–û–û –î–æ—Å—Ç–∞–≤–∏–º –≤ —Å—Ä–æ–∫"`

–ü—Ä–∏–º–µ—Ä:
```bash
curl -X POST 'http://localhost:5139/api/Price/load' \
  -H 'accept: */*' \
  -H 'Content-Type: application/json' \
  -d '"–û–û–û –î–æ—Å—Ç–∞–≤–∏–º –≤ —Å—Ä–æ–∫"'
```

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

```json
[
  {
    "vendor": "Bosch",
    "number": "123456",
    "description": "–§–∏–ª—å—Ç—Ä –º–∞—Å–ª—è–Ω—ã–π...",
    "price": 890.50,
    "count": 10
  }
]
```

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PostgreSQL. –°–æ–∑–¥–∞–π —Ç–∞–±–ª–∏—Ü—É:

```sql
CREATE TABLE "PriceItems" (
    "Id" SERIAL PRIMARY KEY,
    "Vendor" VARCHAR(64),
    "Number" VARCHAR(64),
    "SearchVendor" VARCHAR(64),
    "SearchNumber" VARCHAR(64),
    "Description" VARCHAR(512),
    "Price" NUMERIC(18,2),
    "Count" INTEGER
);
```

---

## üß™ –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å

- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤
- [ ] –§–æ–Ω–æ–≤–∞—è —Å–ª—É–∂–±–∞ (BackgroundService)
- [ ] –õ–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Serilog
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ

---


## –ê–≤—Ç–æ—Ä

–ö—É–ø—Ä–∏—è–Ω–æ–≤ –ú.–ê. 

---

## –°–≤—è–∑—å

–ï—Å–ª–∏ —É —Ç–µ–±—è –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã, —Ç—ã –º–æ–∂–µ—à—å:
- –ù–∞–ø–∏—Å–∞—Ç—å –º–Ω–µ –≤ Telegram: @MaksimKupriyanov_official
- –ò–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∏—Å—å–º–æ: makskupriyanoff@Yandex.ru
```
