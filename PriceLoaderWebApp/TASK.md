# Техническое Задание: Загрузка прайс-листа от поставщика

## Описание задачи

На почтовый ящик компании **ООО "Запчасти даром"** приходит прайс-лист от поставщика **ООО "Доставим в срок"** в формате `.csv`.  
Необходимо реализовать **консольное или web-приложение**, которое:
- Скачивает прайс-лист с почты (через протокол IMAP)
- Парсит CSV файл
- Обрабатывает данные
- Сохраняет их в реляционную базу данных

---

## Входные данные

Необходимо загрузить данные в таблицу `PriceItems` БД со следующей структурой:

| Поле             | Тип               | Назначение |
|------------------|--------------------|------------|
| Vendor           | varchar(64)         | Производитель |
| Number           | varchar(64)         | Номер запчасти |
| SearchVendor     | varchar(64)         | Производитель для поиска (очищенное значение `Vendor`) |
| SearchNumber     | varchar(64)         | Номер для поиска (очищенное значение `Number`) |
| Description      | varchar(512)        | Наименование |
| Price            | decimal(18,2)       | Цена |
| Count            | int                 | Количество |

---

## Источник данных

Прайс-лист — это CSV-файл, который приходит как **вложение к электронному письму**.  
Из файла нужно взять следующие колонки и сопоставить с полями таблицы:

| Колонка в CSV     | Поле в БД          |
|-------------------|---------------------|
| Бренд             | Vendor              |
| Каталожный номер  | Number              |
| Описание          | Description         |
| Цена              | Price               |
| Наличие           | Count               |

---

## Особенности обработки данных

### 1. Конфигурация поставщиков

- Так как компания получает прайсы от нескольких поставщиков, необходимо предусмотреть **гибкую настройку маппинга полей**
- В рамках задачи достаточно реализовать одну конфигурацию под поставщика `"ООО Доставим в срок"`

### 2. Работа с почтой

- Протокол: **IMAP**
- Прайс-лист приходит как вложение к письму
- Формат вложения: **CSV**
- Имя файла не регламентировано, но расширение всегда — `.csv`

### 3. Обработка полей

#### a. `SearchVendor`, `SearchNumber`
- Получаются из `Vendor` и `Number` соответственно
- Из строк удаляются все **небуквенно-цифровые символы**
- Затем строки приводятся к **верхнему регистру**

#### b. `Count`
- Может содержать значения вида:
  - `>10` → `10`
  - `<13` → `13`
  - `10-50` → `50`
- Если значение некорректное — установить `0`

#### c. `Description`
- Если длина больше **512 символов** — обрезается до 512

---

## Требования к архитектуре

- Приложение должно быть **расширяемым**
- Реализация должна поддерживать:
  - Подключение к разным поставщикам
  - Разные форматы прайс-листов
  - Логгирование и обработку ошибок

---

## Дополнительно

- Предпочтительно использовать **MailKit** для работы с IMAP
- Для парсинга CSV можно использовать **CsvHelper** или стандартные средства .NET
- База данных — любая реляционная, предпочтительно **PostgreSQL**
- Приложение должно иметь возможность тестирования и логгирования

---

## Возможные улучшения (не обязательны)

- Автоматическая проверка почты по расписанию
- Web API для управления и запуска импорта
- Механизм фильтрации писем по теме / отправителю
- Поддержка нескольких поставщиков